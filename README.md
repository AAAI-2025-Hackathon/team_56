# MAGMA: Machine-Assisted Geological Mapping and Analysis

A web-based application that combines interactive geological mapping with AI-powered geological analysis. This tool allows users to explore geological features through synchronized maps and receive detailed geological descriptions generated by a large language model.

## Features

### Interactive Mapping
- Synchronized topographic and geological maps
- Real-time map synchronization for seamless exploration
- Integration with Macrostrat geological data
- Google Street View integration for ground-level visualization
- Distance measurement tools

### AI-Powered Analysis
- Integration with DeepSeek LLM for detailed geological descriptions
- Automated analysis of geological formations and features
- Context-aware geological interpretations
- Real-time generation of scientific descriptions

### Data Display
- Basic geological information including:
  - Formation names and ages
  - Rock types and compositions
  - Environmental contexts
- Detailed AI-generated geological analysis
- Coordinate tracking and display
- Street View imagery of accessible locations

### Tools and Utilities
- Distance measurement functionality
- Layer toggling between different map types
- Data export capabilities
- Responsive design for various screen sizes

## Technical Stack

### Frontend
- HTML5/CSS3 for structure and styling
- JavaScript for interactive functionality
- Leaflet.js for map rendering
- Google Maps API for Street View integration

### Backend
- Python/Flask server
- DeepSeek LLM integration
- Macrostrat API integration
- Custom geological data processing

### APIs and Services
- Macrostrat geological data API
- OpenTopoMap for topographic data
- Google Street View API
- DeepSeek LLM for geological analysis

## System Requirements

### Hardware Requirements
- **GPU**: CUDA-compatible GPU recommended
  - Minimum 8GB GPU memory for optimal performance
  - Will fall back to CPU if no GPU is available (significantly slower)
- **RAM**: Minimum 16GB recommended
- **Storage**: At least 15GB free space for model storage

### Software Requirements
- Python 3.8 or higher
- CUDA Toolkit 11.7 or higher (for GPU support)
- Required Python packages are listed in requirements.txt

The `model_setup.py` script will automatically check your system specifications:
- Verifies CUDA availability
- Checks available GPU memory
- Validates system RAM
- Configures optimal model settings based on available hardware

## Installation

1. Clone the repository:
```bash
git clone [repository-url]
cd geological-explorer
```

2. Install Python dependencies:
```bash
pip install -r requirements.txt
```

3. Set up environment variables:
```bash
GOOGLE_MAPS_API_KEY=your_api_key_here
```

4. Initialize the DeepSeek LLM model:
```bash
python setup_script.py
```

The model setup script will:
- Check your system's hardware capabilities (CPU, RAM, GPU)
- Download and configure the DeepSeek LLM model from the official source
- Configure the model based on your system's specifications
- Optimize settings for best performance given available resources
- Perform a test run with a simple geology query to ensure functionality
- Save the optimized model locally in the `local_model` folder for future use

Example output from system check:
```
GPU detected with 16.00GB memory
Available RAM: 32.50GB
Setting up model for GPU...
Downloading tokenizer...
Downloading model... This may take a while...
```

5. Start the Flask server:
```bash
python app.py
```


## Setup Files

This project includes two setup-related files:

1. `model_setup.py`: This file contains the core functionality for setting up the DeepSeek LLM model. It includes methods for checking system requirements, downloading the model, testing it, and saving it locally.

2. `setup_script.py`: This is a user-friendly script that utilizes the functionality in `model_setup.py`. It provides a guided setup process with additional error handling and user prompts. This is the recommended script for users to run when setting up the project.

Both files work together to ensure a smooth setup process, with `setup_script.py` providing a more accessible interface for users.



## Project Structure

```
geological-explorer/
├── app.py                 
├── static/
│   ├── css/
│   │   └── main.css      
│   └── js/
│       └── maps.js      
├── templates/
│   └── index.html      
├── geo_tools/
│   └── __init__.py      
├── llm_processor/
│   └── __init__.py       
└── model_setup.py
│   └── __init__.py       
└── setup_script.py       
```

## Usage

1. Access the application through your web browser at `http://localhost:5000`
2. Click on any point on either map to:
   - View basic geological information
   - Get AI-generated geological descriptions
   - See Street View imagery (if available)
3. Use the measurement tool to calculate distances
4. Toggle between different map layers as needed
5. Export geological data for further analysis

## API Integration

### Macrostrat API
The application integrates with Macrostrat's API for geological data:
```javascript
https://macrostrat.org/api/v2/geologic_units/map?lat=${lat}&lng=${lng}
```

### DeepSeek LLM
Custom implementation for geological description generation using the DeepSeek language model.

## Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/YourFeature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin feature/YourFeature`)
5. Create a new Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

- Macrostrat for geological data
- OpenTopoMap for topographic data
- DeepSeek for the language model
- Google for Street View integration

## Support

For support, please open an issue in the GitHub repository or contact the development team.